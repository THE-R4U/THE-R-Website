<!DOCTYPE html>
<html lang="en-us">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>[Kaggle] Overwatch Analysis</title>
<meta name="description" content=" R 데이터분석에 필요한 패키지 활용, 교육정보 제공">
<meta name="generator" content="Hugo 0.38.1" />
<meta property="og:title" content="[Kaggle] Overwatch Analysis" />
<meta property="og:description" content="#load packages and csv file library(ggplot2) library(dplyr) library(gridExtra) library(fmsb) library(ggthemes) library(ggridges) library(RColorBrewer) library(grid) library(gridExtra) library(ggrepel) library(GGally) library(gplots) library(ggdendro) library(factoextra) library(NbClust) library(corrplot) library(corrgram) warning: according the data the dataset was posted, I estimated it to correspond to patch 1.8.0.2(February 28, 2017), so the data here may not reflect the actual characteristics of the Heroes
Motivation There are 4 types of classes in Overwatch (wikia) :
 Offense: main objective is to scout the area, harass the opposing team, and press the objective." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/2018/04/15/kaggle-overwatch-analysis/" />



<meta property="article:published_time" content="2018-04-15T00:00:00&#43;00:00"/>

<meta property="article:modified_time" content="2018-04-15T00:00:00&#43;00:00"/>











<link rel="dns-prefetch" href="//fonts.googleapis.com" />
<link rel="dns-prefetch" href="//fonts.gstatic.com" />

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,700" type="text/css" media="all" />
<link rel="stylesheet" href="/css/style.css" type="text/css" media="all" />
<script type="text/javascript" src="/js/scripts.js"></script>
<link rel="shortcut icon" href="/favicon.ico">

<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-117555860-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>

</head>
<body class="body body-right-sidebar mobile" itemscope="itemscope" itemtype="http://schema.org/WebPage">
	<div class="container container-outer">
		<header class="header" itemscope="itemscope" itemtype="http://schema.org/WPHeader">
			<div class="container container-inner clearfix">
				<div class="logo" role="banner" itemscope="itemscope" itemtype="http://schema.org/Brand">
					<a class="logo__link" href="/" title="THE-R" rel="home">
						<h1 class="logo__title">THE-R</h1>
						<h2 class="logo__tagline">데이터분석가를 위한 R 황금레시피</h2>
					</a>
				</div>
			</div>
			
<nav class="menu" itemscope="itemscope" itemtype="http://schema.org/SiteNavigationElement">
	<ul class="menu__list">
		<li class="menu__item"><a class="menu__link" href="https://github.com/THE-R4U">GITHUB</a></li>
		<li class="menu__item"><a class="menu__link" href="/categories/">카테고리</a></li>
		<li class="menu__item"><a class="menu__link" href="https://twitter.com/The_R_Blog">트위터</a></li>
		<li class="menu__item"><a class="menu__link" href="https://fb.me/THER4U">페이스북</a></li>
	</ul>
</nav>

		</header>
		<div class="wrapper clearfix">

<main class="main-content content" role="main" itemprop="mainContentOfPage">
	<article class="post">
		<header class="post__header clearfix">
			<h1 class="post__title">[Kaggle] Overwatch Analysis</h1>
			<p class="post__meta meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"/></svg>
				<time class="post__meta-date" datetime="2018-04-15T00:00:00">2018-04-15</time>
				<span class="post__meta-categories meta-categories">
					<svg class="icon icon-category" height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="m7 2l1 2h8v11h-16v-13z"/></svg>
					<a class="meta-categories__link" href="/categories/%ec%ba%90%ea%b8%80" rel="category">캐글</a></span>
			</p>
		</header>
		<div class="post__content clearfix">
			<center>
<img src="http://tca-esports.com/news/overwatch_banner.png">
</center>
<pre class="r"><code>#load packages and csv file
library(ggplot2)
library(dplyr)
library(gridExtra)
library(fmsb)
library(ggthemes)
library(ggridges)
library(RColorBrewer)
library(grid)
library(gridExtra)
library(ggrepel)
library(GGally)
library(gplots)
library(ggdendro)
library(factoextra)
library(NbClust)
library(corrplot)
library(corrgram)</code></pre>
<p><em>warning: according the data the dataset was posted, I estimated it to correspond to <strong>patch 1.8.0.2</strong>(February 28, 2017), so the data here may not reflect the <strong>actual</strong> characteristics of the Heroes</em></p>
<div id="motivation" class="section level1">
<h1>Motivation</h1>
<p>There are 4 types of classes in Overwatch (<a href="http://overwatch.wikia.com/wiki/Role">wikia</a>) :</p>
<ul>
<li><strong>Offense</strong>: main objective is to scout the area, harass the opposing team, and press the objective. Heroes classified as offense generally have high damage weapons and abilities and lower health pools. They are usually excellent duelists with high mobility and good burst or sustained damage.</li>
<li><strong>Defense</strong>: main objective is to guard locations and establish a front. They may have long range weapons or the ability to create turrets, and excel at area denial.</li>
<li><strong>Support</strong>: main objective of support is to heal, buff and provide utility. Support heroes boost the overall performance of their team by increasing their survivability, speed, and damage output.</li>
<li><strong>Tank</strong>: they specialize in protecting allies, disrupting enemies, and occupying the front line. They have high survivability and abilities that protect themselves and others with shields and crowd control.</li>
</ul>
<p>The current data has the abilities list per character:</p>
<ul>
<li>the number of abilities is not the same per character so I will take the <code>median</code> when grouping per character(most of the time there are 2 abilities/character but sometimes there are more than 2 so taking the median rather than the mean is <em>safer</em>)</li>
<li>We can try to <code>cluster</code> the Heroes according their abilities and infer to which class they belong.</li>
</ul>
</div>
<div id="data-preparation" class="section level1">
<h1>Data preparation</h1>
<p>Some data cleaning / features transformations below.</p>
<ul>
<li>create column with name of each heroes based on the attack / ability column.
<ul>
<li>small tweak for <code>Torbj</code></li>
</ul></li>
<li>convert the <code>Life</code> column to numeric.
<ul>
<li>there are few cases, like <code>100/300</code> that need some regexp to extract the mean value.</li>
</ul></li>
<li>add the gender: not really useful for clustering but still interesting to add as feature.</li>
<li>there is 1 row for which I could not find the <code>Heroes_name</code>(the one with name <code>melee</code> so I removed this line).</li>
</ul>
<pre class="r"><code>#load data
df&lt;-read.csv(&#39;../../data/Overwatch_edopic.csv&#39;,sep=&#39;,&#39;,stringsAsFactors=F)

#make list of all heroes name
heroes_name&lt;-c(&#39;Ana&#39;,&#39;Bastion&#39;,&#39;D.va&#39;,&#39;Junkrat&#39;,&#39;Genji&#39;,&#39;Hanzo&#39;,&#39;Lucio&#39;,&#39;McCree&#39;,&#39;Mei&#39;,&#39;Mercy&#39;,&#39;Pharah&#39;,&#39;Reaper&#39;,&#39;Reinhardt&#39;,&#39;Roadhog&#39;,&#39;Soldier&#39;,&#39;Sombra&#39;,&#39;Symmetra&#39;,&#39;Torbj&#39;,&#39;Tracer&#39;,&#39;Widowmaker&#39;,&#39;Winston&#39;,&#39;Zarya&#39;,&#39;Zeny&#39;,&#39;Torretta&#39;)

#loop over the Heroes column to extract the name of the character
x &lt;- vector(mode=&quot;character&quot;, length=nrow(df))
for(i in 1:length(heroes_name)){
    if(heroes_name[i] == &#39;Torretta&#39;){
        temp&lt;-grep(heroes_name[i],df$Heroes)
        for(k in 1:length(temp)){
            x[temp[k]]&lt;-&#39;Torbj&#39;
        }
    } else {
        check&lt;-grep(heroes_name[i],df$Heroes)
        for(j in 1:length(check)){
            x[check[j]]&lt;-heroes_name[i]
            }
        }
}
#make new column with Heroes name
df$Heroes_name&lt;-x

#convert Life to numeric
convertLife&lt;-function(x){
    if(grepl(&#39;\\/&#39;,x)==TRUE){
        res&lt;-(as.numeric(strsplit(x,&#39;/&#39;)[[1]][1]) + as.numeric(strsplit(x,&#39;/&#39;)[[1]][2]))/2.
    }
    else{
        res&lt;-as.numeric(x)
    }
    return(res)
}
df$Life&lt;-sapply(df$Life, convertLife)

#make list of gender
inferGender&lt;-function(x){
  if(x %in% c(&#39;Ana&#39;,&#39;D.va&#39;,&#39;Mei&#39;,&#39;Mercy&#39;,&#39;Pharah&#39;,&#39;Sombra&#39;,&#39;Symmetra&#39;,&#39;Tracer&#39;,&#39;Widowmaker&#39;,&#39;Zarya&#39;)){
    return(&#39;female&#39;)
    }
  else if(x %in% c(&#39;Junkrat&#39;,&#39;Genji&#39;,&#39;Hanzo&#39;,&#39;Lucio&#39;,&#39;McCree&#39;,&#39;Reaper&#39;,&#39;Reinhardt&#39;,&#39;Roadhog&#39;,&#39;Soldier&#39;,&#39;Torbj&#39;)){
    return(&#39;male&#39;)
    }
  else if(x %in% c(&#39;Bastion&#39;,&#39;Zeny&#39;)){
    return(&#39;robot&#39;)
  }
  else if(x %in% c(&#39;Winston&#39;)){
    return(&#39;animal&#39;)
  }
  else return(&#39;other&#39;)
}
df$gender&lt;-sapply(df$Heroes_name, inferGender)

#clean row with empty name
df&lt;-df %&gt;%dplyr::filter(Heroes_name!=&quot;&quot;)

#add color per gender
mycat&lt;-c(&#39;female&#39;,&#39;male&#39;,&#39;robot&#39;,&#39;animal&#39;,&#39;other&#39;)
mycols&lt;-c(&quot;#FF7F00&quot;,&quot;#1F78B4&quot;,&quot;#E31A1C&quot;,&quot;#CAB2D6&quot;,&quot;#999999&quot;)
cols&lt;-data.frame(&#39;gender&#39;=mycat,&#39;color&#39;=mycols)
df&lt;-left_join(df, cols, by=c(&#39;gender&#39;))</code></pre>
</div>
<div id="characterss-distribution-per-ability" class="section level1">
<h1>Characters’s distribution per ability</h1>
<p>The code below is a bit complicated but it’s only because I wanted to make the <code>median</code> attributes histograms in 1 loop:</p>
<ul>
<li><code>listFeatures</code> is an array of columns index.</li>
<li><code>dplyr::select(Heroes_name,index,color)</code> selects the name of heroes of the feature column in the loop; it creates a dataframe with 2 columns : <code>name</code>, <code>current_feature</code> and <code>color</code>.</li>
<li><code>summarise_at(1, median) %&gt;% rename_(val=names(.)[3])</code>: takes the median of the third column(<code>current_feature</code>) and renames it <code>val</code> so that I can make a plot independently of the real name.</li>
</ul>
<pre class="r"><code>listPlot&lt;-list()
listFeatures&lt;-c(2,3,4,5,6,7,8)
for (i in 1:length(listFeatures)){
    index&lt;-listFeatures[i]
    listPlot[[i]]&lt;-df %&gt;% dplyr::select(Heroes_name,index,color) %&gt;% na.omit() %&gt;% 
      dplyr::group_by(Heroes_name,color) %&gt;% dplyr::summarise_at(1,median) %&gt;% 
      rename_(val=names(.)[3]) %&gt;% 
      ggplot(aes(x=reorder(Heroes_name,val),y=val,fill=color)) + 
      geom_histogram(stat=&#39;identity&#39;,width=.5,color=&#39;black&#39;,size=.5) + 
      coord_flip() + theme_fivethirtyeight() + 
      scale_fill_identity() +
      labs(title=colnames(df)[index],
           subtitle=&#39;taken as median&#39;) + 
      theme(axis.text = element_text(size=8),
            plot.title=element_text(face=&quot;bold&quot;,hjust=.012,vjust=.8,colour=&quot;#3C3C3C&quot;,size=12),
            plot.subtitle=element_text(size=8, hjust=0, face=&quot;italic&quot;, color=&quot;black&quot;))
}

#make a gender histogram to be used also as color legend
leg&lt;-df %&gt;% group_by(Heroes_name, gender,color) %&gt;% summarize(count = n_distinct(Heroes_name)) %&gt;% group_by(gender,color) %&gt;% summarize(countG=n()) %&gt;%  ggplot(aes(x=gender,y=countG,fill=color)) + geom_bar(stat=&#39;identity&#39;,color=&#39;black&#39;,size=.5) + 
  scale_fill_identity() + theme_fivethirtyeight() + labs(title=&#39;Heroes distribution\nper gender&#39;) + 
  theme(axis.title = element_blank(),
        plot.title=element_text(face=&quot;bold&quot;,hjust=.012,vjust=.8,colour=&quot;#3C3C3C&quot;,size=12),
        plot.subtitle=element_text(size=8, hjust=0, face=&quot;italic&quot;, color=&quot;black&quot;))</code></pre>
<pre class="r"><code>grid.arrange(listPlot[[1]],listPlot[[2]],listPlot[[3]],listPlot[[4]],listPlot[[5]],listPlot[[6]],listPlot[[7]],leg,ncol=4)</code></pre>
<p><img src="/post/2018-04-15-kaggle-overwatch-analysis_files/figure-html/unnamed-chunk-4-1.png" width="960" style="display: block; margin: auto;" /></p>
<ul>
<li><strong>Bastion</strong> seems a vey good character after all: he trusts 3 of the 7 abilities and he’s well ranked in 2 others.</li>
<li>overall, from my knowledge of the game/characters, this ranking makes sense and somehow agrees with the <a href="http://overwatch.wikia.com/wiki/Role">wikia</a>.</li>
</ul>
</div>
<div id="analysis" class="section level1">
<h1>Analysis</h1>
<div id="look-at-the-raw-data" class="section level2">
<h2>Look at the raw data</h2>
<pre class="r"><code>my_fn &lt;- function(data, mapping, method=&quot;loess&quot;, ...){
      p &lt;- ggplot(data = data, mapping = mapping) + 
      geom_point() + 
      geom_smooth(method=method, ...) + theme_fivethirtyeight() + theme(axis.text = element_text(size=8))
      p
}
ggpairs(df[,-c(1,7,9,10,11)],lower = list(continuous = my_fn))</code></pre>
<p><img src="/post/2018-04-15-kaggle-overwatch-analysis_files/figure-html/unnamed-chunk-5-1.png" width="960" style="display: block; margin: auto;" /></p>
<ul>
<li>some interesting and obvious correlations, for example: <code>Damage.per.second</code> vs. <code>Headshot.DPS</code></li>
<li><code>NanoBoost</code> is one of Ana’s ability to target one ally and shoot an injection to grant them a boost. That player receives a buff for 8 seconds; their attack damage is increased by 50% and gain 50% damage resistance for the duration.
<ul>
<li>the correlation with <code>Damage.per.second</code>, or <code>Headshot.DPS</code> is linear, which somehow makes sense with the definition of <code>nanoboost</code>(increased attack).</li>
</ul></li>
</ul>
</div>
<div id="tank-vs.offense-class" class="section level2">
<h2>Tank vs. Offense class</h2>
<div id="damage_dps-vs.life" class="section level3">
<h3>Damage_DPS vs. Life</h3>
<pre class="r"><code>g1&lt;-df %&gt;% 
  dplyr::select(Heroes_name, Damage.per.second,Life,color) %&gt;% 
  dplyr::group_by(Heroes_name,color) %&gt;% 
  summarize(
    medianDamage = median(Damage.per.second,na.rm=TRUE),
    medianLife = median(Life,na.rm=TRUE)) %&gt;% 
  ggplot(aes(x=medianLife, y= medianDamage, fill=color)) + geom_point(size=2) + 
  geom_label_repel(aes(label=ifelse(medianLife&gt;400 | medianDamage&gt;200,Heroes_name,&quot;&quot;)),size=3,force=1) + 
  theme_fivethirtyeight() + 
  scale_fill_identity() + theme(
    legend.position=&#39;top&#39;,
        plot.title=element_text(face=&quot;bold&quot;,hjust=.012,vjust=.8,colour=&quot;#3C3C3C&quot;,size=12)) +
  labs(title=&#39;median Damage/sec. vs. mean Life&#39;)</code></pre>
</div>
<div id="headshot_dps-vs.life" class="section level3">
<h3>Headshot_DPS vs. Life</h3>
<pre class="r"><code>g2&lt;-df %&gt;% 
  dplyr::select(Heroes_name, Headshot.DPS,Life,color) %&gt;% 
  dplyr::group_by(Heroes_name,color) %&gt;% 
  summarize(
    medianHeadshot = median(Headshot.DPS,na.rm=TRUE),
    medianLife = median(Life,na.rm=TRUE)) %&gt;% 
  ggplot(aes(x=medianLife, y= medianHeadshot, fill=color)) + geom_point(size=2) + 
  geom_label_repel(aes(label=ifelse(medianLife&gt;400 | medianHeadshot&gt;400,Heroes_name,&quot;&quot;)),size=3,force=1) + 
  theme_fivethirtyeight() + 
  scale_fill_identity() + theme(legend.position=&#39;top&#39;,
        plot.title=element_text(face=&quot;bold&quot;,hjust=.012,vjust=.8,colour=&quot;#3C3C3C&quot;,size=12)) +
  labs(title=&#39;median Headshot vs. median Life&#39;)</code></pre>
</div>
<div id="singleshot-vs.life" class="section level3">
<h3>Singleshot vs. Life</h3>
<pre class="r"><code>g3&lt;-df %&gt;% 
  dplyr::select(Heroes_name,Single.shot,Life,color) %&gt;% 
  dplyr::group_by(Heroes_name,color) %&gt;% 
  summarize(
    medianSingleShot = median(Single.shot,na.rm=TRUE),
    medianLife = median(Life,na.rm=TRUE)) %&gt;% 
  ggplot(aes(x=medianLife, y= medianSingleShot, fill=color)) + geom_point(size=2) + 
  geom_label_repel(aes(label=ifelse(medianLife&gt;400 | medianSingleShot&gt;100,Heroes_name,&quot;&quot;)),size=3,force=1) + 
  theme_fivethirtyeight() + 
  scale_fill_identity() + theme(legend.position=&#39;top&#39;,
        plot.title=element_text(face=&quot;bold&quot;,hjust=.012,vjust=.8,colour=&quot;#3C3C3C&quot;,size=12)) +
  labs(title=&#39;median SingleShot vs. median Life&#39;)</code></pre>
<pre class="r"><code>grid.arrange(g1, g2, g3, ncol=3)</code></pre>
<p><img src="/post/2018-04-15-kaggle-overwatch-analysis_files/figure-html/unnamed-chunk-9-1.png" width="960" style="display: block; margin: auto;" /></p>
<ul>
<li>again we see some delimitations between characters based on these 3 abilities:
<ul>
<li>high life characters and high <code>DPS</code> characters can be grouped into clusters.</li>
</ul></li>
<li><strong>Reaper</strong> looks a powerfull character: high <code>DPS</code> and high <code>SingleShot</code> and a good amount of health.</li>
</ul>
</div>
</div>
<div id="radarcharts" class="section level2">
<h2>Radarcharts</h2>
<p>For the <code>radarcharts</code>, some manipulation was needed:</p>
<ul>
<li>there are some <code>Inf</code> values, taken as numeric. These values will appear as <code>Inf</code> too when taking the median so I replace them by <code>0</code> before <code>grouping_by --&gt; median</code></li>
<li>I kept all columns to make a comparison for all characters ; since all characters do not have the same abilities in this dataset, the simplest would have to drop these columns. At the end, I decided to keep these columns.</li>
<li>after the <code>grouping_by --&gt; median</code>, there were still some <code>NA</code>; that explains the <code>mutate</code> part in the pipe.
<ul>
<li><strong>So when a character will have a <code>0</code> value, it means that there were no data for this character/ability.</strong></li>
</ul></li>
<li>the rest of the code appends the <code>color, Name</code> of heroes, calculate <code>min/max</code> needed for the radarcharts.</li>
</ul>
<pre class="r"><code>#repalce Inf by 0
df&lt;-do.call(data.frame,lapply(df, function(x) replace(x, is.infinite(x),NA)))

#group_by Heroes, calculate median for all columns, repalce final NA&#39;s, save result in a list
dataPerChar&lt;-list()      
for(i in 1:(length(heroes_name)-1)){
  dataPerChar[[i]]&lt;-data.frame(
    df %&gt;% dplyr::filter(Heroes_name==heroes_name[i]) %&gt;% 
      dplyr::select_if(is.numeric) %&gt;% 
      dplyr::summarise_all(funs(mean(., na.rm = TRUE))) %&gt;% 
      dplyr::mutate(Damage.per.second = ifelse(is.na(Damage.per.second), 0, Damage.per.second),
                    Headshot.DPS = ifelse(is.na(Headshot.DPS), 0, Headshot.DPS),
                    Single.shot = ifelse(is.na(Single.shot), 0, Single.shot),
                    Nanoboost.DPS = ifelse(is.na(Nanoboost.DPS), 0, Nanoboost.DPS),
                    Health.per.Sec = ifelse(is.na(Health.per.Sec), 0, Health.per.Sec),
                    Life = ifelse(is.na(Life), 0, Life),
                    Reload = ifelse(is.na(Reload), 0, Reload)))
}

#make a dataframe, add additional features, prepare radarcharts
res&lt;-do.call(&quot;rbind&quot;,dataPerChar)
res$Heroes_name&lt;-heroes_name[-length(heroes_name)]
res&lt;-left_join(res,df %&gt;% select(Heroes_name,color) %&gt;% distinct(),by=&#39;Heroes_name&#39;)
min&lt;-rep.int(0,7)
max&lt;- ceiling(apply(res[,1:7], 2, function(x) max(x, na.rm = TRUE)) %&gt;% sapply(as.double)) %&gt;% as.vector
colnames(res)&lt;-c(&#39;Damage/sec&#39;,&#39;Headshot.DPS&#39;,&#39;SingleShot&#39;,&#39;Nanoboost.DPS&#39;,&#39;Health/sec&#39;,&#39;Life&#39;,&#39;Reload&#39;,&#39;Heroes_name&#39;,&#39;color&#39;)</code></pre>
<pre class="r"><code>par(mfrow=c(6,4))
par(mar=c(1,1,1,1))
for(i in 1:nrow(res)){
  curCol&lt;-(col2rgb(as.character(res$color[i]))%&gt;% as.integer())/255
  radarchart(rbind(max,min,res[i,1:7]),
             axistype=2 , 
             pcol=rgb(curCol[1],curCol[2],curCol[3], alpha = 1) ,
             pfcol=rgb(curCol[1],curCol[2],curCol[3],.5) ,
             plwd=2 , cglcol=&quot;grey&quot;, cglty=1, 
             axislabcol=&quot;black&quot;, caxislabels=seq(0,2000,5), cglwd=0.8, vlcex=0.8,
             title=as.character(res$Heroes_name[i]))
}</code></pre>
<p><img src="/post/2018-04-15-kaggle-overwatch-analysis_files/figure-html/unnamed-chunk-11-1.png" width="960" style="display: block; margin: auto;" /></p>
<ul>
<li><code>Bastion</code> overpowered-abilities are better displayed in these charts; clearly a very good character in many abilities</li>
<li><code>Reaper</code> also appears on top on the <code>Offense</code> character with high values for <code>SingleShot</code>,<code>HeadShot</code> and <code>Damage/sec</code></li>
<li>we also see specific characters, like <code>Phara</code> excelling in <code>HeadShot</code>, <code>Symmetra</code> for <code>Reload</code> or <code>Winston</code> for having the largest pool of <code>Life</code>.</li>
</ul>
</div>
</div>
<div id="dendograms" class="section level1">
<h1>Dendograms</h1>
<p>The issue with using a dendogram here is that the dataset is quite sparse, because of the <code>NA</code> or <code>Inf</code> values. One trick however is to :</p>
<ul>
<li>cluster per Character by taking the median by column</li>
<li>flag the <code>NA</code>, <code>Inf</code> with a negative value</li>
<li>define your own cluster / distance method</li>
</ul>
<pre class="r"><code>meanVal&lt;-list()
for(i in 1:(length(heroes_name)-1)){
    meanVal[[i]]&lt;-df %&gt;% filter(Heroes_name==heroes_name[i]) %&gt;% select_if(is.numeric) %&gt;% colMeans(na.rm=T)
}

res&lt;-do.call(&quot;rbind&quot;,meanVal)
res[!is.finite(res) | is.na(res)] &lt;- -1

rownames(res)&lt;-heroes_name[-length(heroes_name)]
colnames(res)&lt;-c(&#39;Damage/sec&#39;,&#39;Headshot.DPS&#39;,&#39;SingleShot&#39;,&#39;Nanoboost.DPS&#39;,&#39;Health/sec&#39;,&#39;Life&#39;,&#39;Reload&#39;)

breaks = seq(0,max(res),length.out=1000)
gradient1 = colorpanel( sum( breaks[-1]&lt;=0 ), &quot;green&quot;, &quot;black&quot; )
gradient2 = colorpanel( sum( breaks[-1]&gt;0 ), &quot;black&quot;, &quot;red&quot; )
hm.colors = c(gradient1,gradient2)
hm.colors[1] = col2hex(&quot;gray&quot;)

# Clustering and distance measure functions
hclustfunc &lt;- function(x) hclust(x, method=&quot;complete&quot;)
distfunc &lt;- function(x) dist(x,method=&quot;maximum&quot;)</code></pre>
<pre class="r"><code>heatmap.2(res,
          scale=&quot;none&quot;,
          breaks=breaks,
          col=hm.colors,
          na.color=&quot;gray&quot;,
          dendrogram=&quot;row&quot;, 
          hclust=hclustfunc,
          distfun=distfunc,
          main = &quot;Characters&#39;s abilities,\nNA or Inf values in gray&quot;,
          cexRow=.8,cexCol=.8)</code></pre>
<p><img src="/post/2018-04-15-kaggle-overwatch-analysis_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="clusters" class="section level1">
<h1>Clusters</h1>
<p>In this section, I’m using the average abilities per character so each character should have either the mean value, or the flagged <code>-1</code> is there were <code>NA</code> or <code>Inf</code></p>
<pre class="r"><code>res_df&lt;-data.frame(res)
res_df$Heroes_name&lt;-rownames(res_df)
res_df&lt;-left_join(res_df,df %&gt;% distinct(Heroes_name, color, gender), by=&#39;Heroes_name&#39;)</code></pre>
<div id="correlation" class="section level2">
<h2>Correlation</h2>
<p>Similar to the previous section, we can look at the correlation.</p>
<pre class="r"><code>corrplot(cor(res_df %&gt;% select_if(is.numeric),method=&#39;pearson&#39;)
  ,method=&#39;ellipse&#39;,
  order=&quot;AOE&quot;,
  tl.cex=1,
  col= viridis::viridis(100),
  tl.col=&quot;black&quot;)</code></pre>
<p><img src="/post/2018-04-15-kaggle-overwatch-analysis_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<ul>
<li>The correlation I can understand(<code>Reload</code> vs. <code>Damage per sec.</code>), small positive correlatio) makes sense if <code>Reload</code> feature corresponds to the time it takes to reload a weapon.</li>
<li>The anticorrelation(<code>Reload</code> vs. <code>Damage per sec.</code>) is a bit difficult to understand w/o knowledge of what the features in this dataset really correspond to.</li>
</ul>
</div>
<div id="clustering-the-dataset" class="section level2">
<h2>Clustering the dataset</h2>
<p>There are 4 classes, so lets try to clusters from 2 to 5(taking values a bit lower/higher).</p>
<pre class="r"><code>clusPlot&lt;-list()
cnt&lt;-0
for(i in 2:5){
  cnt&lt;-cnt+1
  resClus &lt;- kmeans(res_df %&gt;% select_if(is.numeric), i, nstart = 1)
  clusPlot[[cnt]]&lt;-fviz_cluster(
    resClus, 
    data = res_df %&gt;% select_if(is.numeric) , 
    geom = &quot;point&quot;, 
    stand = TRUE,
    frame.type = &quot;norm&quot;,
    repel=T,
    show.clust.cent=F ,
    ggtheme = theme_fivethirtyeight(),
    outlier.color = &quot;black&quot;) +
    ggtitle(paste0(&quot;# of Clusters:&quot;,i))
  }</code></pre>
<pre class="r"><code>do.call(grid.arrange, c(clusPlot,ncol=4))</code></pre>
<p><img src="/post/2018-04-15-kaggle-overwatch-analysis_files/figure-html/unnamed-chunk-17-1.png" width="960" style="display: block; margin: auto;" /></p>
<ul>
<li>from the clusters plots, it looks like <code>Nclus = 3</code>(3 classes) would be a good value to clusters the data.</li>
</ul>
<div id="check-nclus-3" class="section level3">
<h3>Check: <code>Nclus = 3</code></h3>
<pre class="r"><code>res_clean &lt;- as.data.frame(scale(res_df %&gt;% select_if(is.numeric)))
ff &lt;- dist(res_clean, method = &quot;euclidean&quot;)
g1&lt;-fviz_nbclust(res_clean, kmeans, method = &quot;wss&quot;)
g2&lt;-fviz_nbclust(res_clean, kmeans, method = &quot;silhouette&quot;)</code></pre>
<pre class="r"><code>grid.arrange(g1,g2,ncol=2)</code></pre>
<p><img src="/post/2018-04-15-kaggle-overwatch-analysis_files/figure-html/unnamed-chunk-19-1.png" width="960" style="display: block; margin: auto;" /></p>
<ul>
<li>clustering by <code>silhouette</code> (via <a href="http://www.sthda.com/english/articles/29-cluster-validation-essentials/97-cluster-validation-statistics-must-know-methods/">http://www.sthda.com</a>:<em>The silhouette analysis measures how well an observation is clustered and it estimates the average distance between clusters. The silhouette plot displays a measure of how close each point in one cluster is to points in the neighboring clusters</em>) is agree with <code>Nclus = 3</code> :-)</li>
</ul>
<hr>
<p><strong>History :</strong></p>
<ul>
<li><em>version 1: initial commit</em></li>
<li><em>version 2: added radarcharts</em></li>
<li><em>version 3: added dendograms</em></li>
<li><em>version 4: added clusters section</em></li>
</ul>
<hr>
</div>
</div>
</div>

		</div>
		
<div class="post__tags tags clearfix">
	<svg class="icon icon-tag" width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="m4.73135 3.3795002q0-.5597-.39604-.9557-.39604-.3961-.95577-.3961-.55974 0-.95578.3961-.39604.396-.39604.9557 0 .5598.39604.9558.39604.3961.95578.3961.55973 0 .95577-.3961.39604-.396.39604-.9558zm11.26865 6.0832q0 .5596998-.39076.9504998l-5.18548 5.196q-.41188.3908-.9610504.3908-.55974 0-.9505-.3908l-7.5511496-7.5616998q-.40132-.3907-.68119-1.0666-.27987-.6759-.27987-1.2357v-4.3934q0-.54920004.40132-.95050004.40132-.4013.9505-.4013h4.39339q.55974 0 1.23565.2799.67591.2798 1.07723.6812l7.55115 7.54060004q.39076.4118.39076.961z"/></svg>
	<ul class="tags__list">
		<li class="tags__item"><a class="tags__link" href="/tags/overwatch/" rel="tag">Overwatch</a></li>
		<li class="tags__item"><a class="tags__link" href="/tags/%EC%BA%90%EA%B8%80/" rel="tag">캐글</a></li>
	</ul>
</div>

	</article>
	
<div class="authorbox clearfix">
	<figure class="authorbox__avatar">
		<img alt="THE-R avatar" src="/img/THE-R.jpg" class="avatar" height="90" width="90">
	</figure>
	<div class="authorbox__header">
		<span class="authorbox__name">About THE-R</span>
	</div>
	<div class="authorbox__description">
		THE-R 편집자 입니다
	</div>
</div>
	
<nav class="post-nav row clearfix" itemscope="itemscope" itemtype="http://schema.org/SiteNavigationElement">
	<div class="post-nav__item post-nav__item--prev col-1-2">
		<a class="post-nav__link" href="/2018/04/15/worldcup-goal/" rel="prev"><span class="post-nav__caption">«Previous</span><p class="post-nav__post-title">[캐글] 월드컵 골 분석</p></a>
	</div>
</nav>

	
<div class="comments">
	<div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "THE-R" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

</main>

<aside class="sidebar" itemscope="itemscope" itemtype="http://schema.org/WPSideBar">
	
<div class="widget-search widget">
	<form class="widget-search__form" role="search" method="get" action="//google.com/search">
		<label>
			<span class="screen-reader-text">Search for:</span>
			<input class="widget-search__field" type="search" placeholder="SEARCH..." value="" name="q">
		</label>
		<input class="widget-search__submit" type="submit" value="Search">
		<input type="hidden" name="sitesearch" value="/" />
	</form>
</div>
	
<div class="widget-recent widget">
	<h4 class="widget__title">Recent Posts</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/2018/04/15/kaggle-overwatch-analysis/">[Kaggle] Overwatch Analysis</a></li>
			<li class="widget__item"><a class="widget__link" href="/2018/04/15/worldcup-goal/">[캐글] 월드컵 골 분석</a></li>
			<li class="widget__item"><a class="widget__link" href="/2018/04/12/rpackage-network3d/">[R 패키지] 3D 네트워크 시각화 - network3d</a></li>
			<li class="widget__item"><a class="widget__link" href="/2016/12/30/a-plain-markdown-post/">A Plain Markdown Post</a></li>
			<li class="widget__item"><a class="widget__link" href="/2015/07/23/hello-r-markdown/">Hello R Markdown</a></li>
		</ul>
	</div>
</div>

	
<div class="widget-categories widget">
	<h4 class="widget__title">Categories</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/categories/r">R</a></li>
			<li class="widget__item"><a class="widget__link" href="/categories/r-%ed%8c%a8%ed%82%a4%ec%a7%80">R-패키지</a></li>
			<li class="widget__item"><a class="widget__link" href="/categories/%ec%ba%90%ea%b8%80">캐글</a></li>
		</ul>
	</div>
</div>
	
<div class="widget-social widget">
	<h4 class="widget-social__title widget__title">Social</h4>
	<div class="widget-social__content widget__content">
		<div class="widget-social__item widget__item">
			<a class="widget-social__link widget__link btn" title="Facebook" rel="noopener noreferrer" href="https://facebook.com/THER4U" target="_blank">
				<svg class="widget-social__link-icon icon-facebook" viewBox="0 0 352 352" width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill="#fff"><path d="m0 32v288c0 17.5 14.5 32 32 32h288c17.5 0 32-14.5 32-32v-288c0-17.5-14.5-32-32-32h-288c-17.5 0-32 14.5-32 32zm320 0v288h-83v-108h41.5l6-48h-47.5v-31c0-14 3.5-23.5 23.5-23.5h26v-43.5c-4.4-.6-19.8-1.5-37.5-1.5-36.9 0-62 22.2-62 63.5v36h-42v48h42v108h-155v-288z"/></svg>
				<span>Facebook</span>
			</a>
		</div>
		
		<div class="widget-social__item widget__item">
			<a class="widget-social__link widget__link btn" title="Twitter" rel="noopener noreferrer" href="https://twitter.com/The_R_blog" target="_blank">
				<svg class="widget-social__link-icon icon-twitter" viewBox="0 0 384 312" width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill="#fff"><path d="m384 36.9c-14.1 6.3-29.3 10.5-45.2 12.4 16.3-9.7 28.8-25.2 34.6-43.6-15.2 9-32.1 15.6-50 19.1-14.4-15.2-34.9-24.8-57.5-24.8-43.5 0-78.8 35.3-78.8 78.8 0 6.2.7 12.2 2 17.9-65.5-3.3-123.5-34.6-162.4-82.3-6.7 11.6-10.6 25.2-10.6 39.6 0 27.3 13.9 51.4 35 65.6-12.9-.4-25.1-4-35.7-9.9v1c0 38.2 27.2 70 63.2 77.2-6.6 1.8-13.6 2.8-20.8 2.8-5.1 0-10-.5-14.8-1.4 10 31.3 39.1 54.1 73.6 54.7-27 21.1-60.9 33.7-97.8 33.7-6.4 0-12.6-.4-18.8-1.1 34.9 22.4 76.3 35.4 120.8 35.4 144.9 0 224.1-120 224.1-224.1 0-3.4-.1-6.8-.2-10.2 15.4-11.1 28.7-25 39.3-40.8z"/></svg>
				<span>Twitter</span>
			</a>
		</div>
		<div class="widget-social__item widget__item">
			<a class="widget-social__link widget__link btn" title="LinkedIn" rel="noopener noreferrer" href="https://linkedin.com/in/irichgreen" target="_blank">
				<svg class="widget-social__link-icon icon-linkedin" viewBox="0 0 352 352" width="24" height="24" fill="#fff" xmlns="http://www.w3.org/2000/svg"><path d="M0,40v272c0,21.9,18.1,40,40,40h272c21.9,0,40-18.1,40-40V40c0-21.9-18.1-40-40-40H40C18.1,0,0,18.1,0,40z M312,32 c4.6,0,8,3.4,8,8v272c0,4.6-3.4,8-8,8H40c-4.6,0-8-3.4-8-8V40c0-4.6,3.4-8,8-8H312z M59.5,87c0,15.2,12.3,27.5,27.5,27.5 c15.2,0,27.5-12.3,27.5-27.5c0-15.2-12.3-27.5-27.5-27.5C71.8,59.5,59.5,71.8,59.5,87z M187,157h-1v-21h-45v152h47v-75 c0-19.8,3.9-39,28.5-39c24.2,0,24.5,22.4,24.5,40v74h47v-83.5c0-40.9-8.7-72-56.5-72C208.5,132.5,193.3,145.1,187,157z M64,288h47.5 V136H64V288z"/></svg>
				<span>LinkedIn</span>
			</a>
		</div>
		<div class="widget-social__item widget__item">
			<a class="widget-social__link widget__link btn" title="GitHub" rel="noopener noreferrer" href="https://github.com/the-r4u" target="_blank">
				<svg class="widget-social__link-icon icon-github" viewBox="0 0 384 374" width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill="#fff"><path d="m192 0c-106.1 0-192 85.8-192 191.7 0 84.7 55 156.6 131.3 181.9 9.6 1.8 13.1-4.2 13.1-9.2 0-4.6-.2-16.6-.3-32.6-53.4 11.6-64.7-25.7-64.7-25.7-8.7-22.1-21.3-28-21.3-28-17.4-11.9 1.3-11.6 1.3-11.6 19.3 1.4 29.4 19.8 29.4 19.8 17.1 29.3 44.9 20.8 55.9 15.9 1.7-12.4 6.7-20.8 12.2-25.6-42.6-4.8-87.5-21.3-87.5-94.8 0-20.9 7.5-38 19.8-51.4-2-4.9-8.6-24.3 1.9-50.7 0 0 16.1-5.2 52.8 19.7 15.3-4.2 31.7-6.4 48.1-6.5 16.3.1 32.7 2.2 48.1 6.5 36.7-24.8 52.8-19.7 52.8-19.7 10.5 26.4 3.9 45.9 1.9 50.7 12.3 13.4 19.7 30.5 19.7 51.4 0 73.7-44.9 89.9-87.7 94.6 6.9 5.9 13 17.6 13 35.5 0 25.6-.2 46.3-.2 52.6 0 5.1 3.5 11.1 13.2 9.2 76.2-25.5 131.2-97.3 131.2-182 0-105.9-86-191.7-192-191.7z"/></svg>
				<span>GitHub</span>
			</a>
		</div>
		<div class="widget-social__item widget__item">
			<a class="widget-social__link widget__link btn" title="Google Plus" rel="noopener noreferrer" href="https://plus.google.com/profileid" target="_blank">
				<svg class="widget-social__link-icon icon-googleplus" viewBox="0 0 512 512" width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill="#fff"><path d="M0 279c-2-92 66-170 156-173 43-2 83 15 115 45l-43 45C201 177 167 164 132 177c-53 19-81 81-62 136s79 85 132 64c28-11 45-38 53-64l-92 0v-60H320c0 49-4 98-34 136-60 70-162 77-228 15C22 373 2 328 0 279L0 279zM418 205h47l0 49H512v49h-47l0 49h-47v-49h-47v-49h47V205z"/></svg>
				<span>profileid</span>
			</a>
		</div>
		<div class="widget-social__item widget__item">
			<a class="widget-social__link widget__link btn" title="Email" href="mailto:ceo@the-r.kr">
				<svg class="widget-social__link-icon icon-mail" viewBox="0 0 416 288" width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill="#fff"><path d="m0 16v256 16h16 384 16v-16-256-16h-16-384-16zm347 16-139 92.5-139-92.5zm-148 125.5 9 5.5 9-5.5 167-111.5v210h-352v-210z"/></svg>
				<span>ceo@the-r.kr</span>
			</a>
		</div>
	</div>
</div>

	
<div class="widget-taglist widget">
	<h4 class="widget__title">Tags</h4>
	<div class="widget__content">
		<a class="widget__link widget__link--taglist" href="/tags/network3d" title="network3d">network3d (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/overwatch" title="overwatch">overwatch (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/plot" title="plot">plot (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/r-markdown" title="r-markdown">r-markdown (2)</a>
		<a class="widget__link widget__link--taglist" href="/tags/r-%ed%8c%a8%ed%82%a4%ec%a7%80" title="r-패키지">r-패키지 (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/regression" title="regression">regression (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/%ec%8b%9c%ea%b0%81%ed%99%94" title="시각화">시각화 (2)</a>
		<a class="widget__link widget__link--taglist" href="/tags/%ec%ba%90%ea%b8%80" title="캐글">캐글 (2)</a>
	</div>
</div>
</aside>

	</div>
		<footer class="footer" itemscope="itemscope" itemtype="http://schema.org/WPFooter">
			<div class="container container-inner">
				<p class="footer__copyright">&copy; 2018 THE-R. <span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad theme</a>.</span></p>
			</div>
		</footer>
	</div>

<script>
	var navigation = responsiveNav(".menu", {
		navClass: "menu--collapse",
	});
</script>
</body>
</html>
